<div class="modal-backdrop" (click)="onClose()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Detalles del Producto</h2>
      <button class="btn-close" (click)="onClose()" aria-label="Cerrar">×</button>
    </div>

    <div class="modal-body">
      @if (product) {
        <div class="detail-grid">
          <div class="detail-item">
            <span class="detail-label">Nombre:</span>
            <span class="detail-value">{{ product.name }}</span>
          </div>

          <div class="detail-item">
            <span class="detail-label">Código:</span>
            <span class="detail-value">{{ product.productCode || '—' }}</span>
          </div>

          <div class="detail-item">
            <span class="detail-label">Tipo:</span>
            <span class="detail-value">{{ product.type || '—' }}</span>
          </div>

          <div class="detail-item">
            <span class="detail-label">Precio Unitario:</span>
            <span class="detail-value price">{{ product.unitPrice | number: '1.2-2' }} €</span>
          </div>

          <div class="detail-item" [class.low-stock]="isLowStock()">
            <span class="detail-label">Stock Actual:</span>
            <span class="detail-value stock">{{ product.currentStock }} {{ product.unit }}</span>
          </div>

          <div class="detail-item">
            <span class="detail-label">Stock Mínimo:</span>
            <span class="detail-value">{{ product.minStock || '—' }} {{ product.unit }}</span>
          </div>

          <div class="detail-item">
            <span class="detail-label">Unidad:</span>
            <span class="detail-value">{{ product.unit }}</span>
          </div>

          <div class="detail-item full-width">
            <span class="detail-label">Proveedor:</span>
            <span class="detail-value">{{ product.supplier?.name || '—' }}</span>
          </div>

          @if (product.description) {
            <div class="detail-item full-width">
              <span class="detail-label">Descripción:</span>
              <span class="detail-value">{{ product.description }}</span>
            </div>
          }
        </div>

        @if (isLowStock()) {
          <div class="alert-banner">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              fill="currentColor"
              viewBox="0 0 16 16"
            >
              <path
                d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"
              />
            </svg>
            <span>Stock bajo: Por debajo del mínimo recomendado</span>
          </div>
        }
      }
    </div>

    <div class="modal-footer">
      @if (isAdmin) {
        <div class="admin-actions">
          <button class="btn-stock-action" (click)="onAdjustStock()">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              viewBox="0 0 16 16"
            >
              <path
                d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"
              />
            </svg>
            Ajustar Stock
          </button>
          <button class="btn-edit-action" (click)="onEdit()">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              viewBox="0 0 16 16"
            >
              <path
                d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"
              />
              <path
                fill-rule="evenodd"
                d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"
              />
            </svg>
            Editar Producto
          </button>
        </div>
      }
      <button class="btn-close-footer" (click)="onClose()">Cerrar</button>
    </div>
  </div>
</div>
