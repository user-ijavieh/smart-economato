<div class="modal-overlay" (click)="onOverlayClick($event)">
  <div class="modal-container">
    <div class="modal-content">
      <div class="modal-header">
        <h2>{{ product?.name }}</h2>
        <button class="modal-close" (click)="onClose()">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>

      <div class="modal-body">
        @if (product) {
          <!-- Información General -->
          <div class="modal-section">
            <h4>Información General</h4>
            <table class="details-table">
              <tbody>
                <tr>
                  <td class="detail-label">Código</td>
                  <td>{{ product.productCode || '—' }}</td>
                </tr>
                <tr>
                  <td class="detail-label">Tipo</td>
                  <td>{{ product.type || '—' }}</td>
                </tr>
                <tr>
                  <td class="detail-label">Unidad</td>
                  <td>{{ product.unit }}</td>
                </tr>
                <tr>
                  <td class="detail-label">Proveedor</td>
                  <td>{{ product.supplier?.name || '—' }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Precio y Stock -->
          <div class="modal-section">
            <h4>Precio y Stock</h4>
            <table class="details-table">
              <tbody>
                <tr>
                  <td class="detail-label">Precio Unitario</td>
                  <td class="price-value">{{ product.unitPrice | number: '1.2-2' }} €</td>
                </tr>
                <tr [class.low-stock-row]="isLowStock()">
                  <td class="detail-label">Stock Actual</td>
                  <td>{{ product.currentStock }} {{ product.unit }}</td>
                </tr>

              </tbody>
            </table>
          </div>

          <!-- Descripción -->
          @if (product.description) {
            <div class="modal-section">
              <h4>Descripción</h4>
              <p>{{ product.description }}</p>
            </div>
          }

          <!-- Alerta Stock Bajo -->
          @if (isLowStock()) {
            <div class="alert-banner">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
              </svg>
              <span>Stock bajo: Por debajo del mínimo recomendado</span>
            </div>
          }
        }
      </div>

      <!-- Pie del modal -->
      <div class="modal-footer">
        <div class="modal-actions">
          @if (isAdmin) {
            <button class="btn-stock" (click)="onAdjustStock()">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
              Ajustar Stock
            </button>
            <button class="btn-editar" (click)="onEdit()">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
              Editar Producto
            </button>
          }
        </div>
      </div>
    </div>
  </div>
</div>
